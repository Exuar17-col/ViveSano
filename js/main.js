const productos = [
    //Desayunos
        {
        "id": "desayuno-01",
        "titulo": "Cereal con arandanos",
        "imagen": "../img/desayunos/01.jpg",
        "categoria": {
            "nombre": "Desayunos",
            "id": "desayunos"
        },
        "precio": 6000
        },
        {
        "id": "",
        "titulo": "Sandwich con malteada",
        "imagen": "../img/desayunos/02.jpg",
        "categoria": {
            "nombre": "Desayunos",
            "id": "desayunos"
        },
        "precio": 12000
        },
        {
        "id": "desayuno-03",
        "titulo": "Huevos cosidos con frutas",
        "imagen": "../img/desayunos/03.jpg",
        "categoria": {
            "nombre": "Desayunos",
            "id": "desayunos"
        },
        "precio": 12000
        },
        {
        "id": "desayuno-04",
        "titulo": "Tostadas de aguacate",
        "imagen": "../img/desayunos/04.jpg",
        "categoria": {
            "nombre": "Desayunos",
            "id": "desayunos"
        },
        "precio": 13000
        },
        {
        "id": "desayuno-05",
        "titulo": "Ensalada de frutas",
        "imagen": "../img/desayunos/05.jpg",
        "categoria": {
            "nombre": "Desayunos",
            "id": "desayunos"
        },
        "precio": 11000
        },
        {
        "id": "desayuno-06",
        "titulo": "Tortillas de trigo",
        "imagen": "../img/desayunos/06.jpg",
        "categoria": {
            "nombre": "Desayunos",
            "id": "desayunos"
        },
        "precio": 12500
        },
        {
        "id": "desayuno-07",
        "titulo": "Parfait de yogur",
        "imagen": "../img/desayunos/07.jpg",
        "categoria": {
            "nombre": "Desayunos",
            "id": "desayunos"
        },
        "precio": 13200
        },
        {
        "id": "desayuno-08",
        "titulo": "Smoothie bowl",
        "imagen": "../img/desayunos/08.jpg",
        "categoria": {
            "nombre": "Desayunos",
            "id": "desayunos"
        },
        "precio": 17000
        },
    //Almuerzos
        {
        "id": "almuerzo-01",
        "titulo": "Fideos de arroz con rollitos de primavera",
        "imagen": "../img/almuerzos/01.jpg",
        "categoria": {
            "nombre": "Almuerzos",
            "id": "almuerzos"
        },
        "precio": 22000
        },
        {
        "id": "almuerzo-02",
        "titulo": "Ensalada Cesar con pollo",
        "imagen": "../img/almuerzos/02.jpg",
        "categoria": {
            "nombre": "Almuerzos",
            "id": "almuerzos"
        },
        "precio": 18500
        },
        {
        "id": "almuerzo-03",
        "titulo": "Lomo de cerdo",
        "imagen": "../img/almuerzos/03.jpg",
        "categoria": {
            "nombre": "Almuerzos",
            "id": "almuerzos"
        },
        "precio": 25300
        },
        {
        "id": "almuerzo-04",
        "titulo": "Poke blowl",
        "imagen": "../img/almuerzos/04.jpg",
        "categoria": {
            "nombre": "Almuerzos",
            "id": "almuerzos"
        },
        "precio": 18500
        },
        {
        "id": "almuerzo-05",
        "titulo": "Col curtida",
        "imagen": "../img/almuerzos/05.jpg",
        "categoria": {
            "nombre": "Almuerzos",
            "id": "almuerzos"
        },
        "precio": 20000
        },
        {
        "id": "almuerzo-06",
        "titulo": "Plato de sopa",
        "imagen": "../img/almuerzos/06.jpg",
        "categoria": {
            "nombre": "Almuerzos",
            "id": "almuerzos"
        },
        "precio": 13000
        },
        {
        "id": "almuerzo-07",
        "titulo": "Sopa vietnamita",
        "imagen": "../img/almuerzos/07.jpg",
        "categoria": {
            "nombre": "Almuerzos",
            "id": "almuerzos"
        },
        "precio": 15200
        },
        {
        "id": "almuerzo-08",
        "titulo": "poke bowl",
        "imagen": "../img/almuerzos/08.jpg",
        "categoria": {
            "nombre": "Almuerzos",
            "id": "almuerzos"
        },
        "precio": 12500
        },
    //Cenas
        {
        "id": "cena-01",
        "titulo": "Sopa de calabaza",
        "imagen": "../img/cenas/01.jpg",
        "categoria": {
            "nombre": "Cenas",
            "id": "cenas"
        },
        "precio": 14500
        },
        {
        "id": "cena-02",
        "titulo": "Snacks con huevo",
        "imagen": "../img/cenas/02.jpg",
        "categoria": {
            "nombre": "Cenas",
            "id": "cenas"
        },
        "precio": 13700
        },
        {
        "id": "cena-03",
        "titulo": "Sopa de tomate",
        "imagen": "../img/cenas/03.jpg",
        "categoria": {
            "nombre": "Cenas",
            "id": "cenas"
        },
        "precio": 13200
        },
        {
        "id": "cena-04",
        "titulo": "Esparragos",
        "imagen": "../img/cenas/04.jpg",
        "categoria": {
            "nombre": "Cenas",
            "id": "cenas"
        },
        "precio": 12800
        },
        {
        "id": "cena-05",
        "titulo": "Sushi",
        "imagen": "../img/cenas/05.jpg",
        "categoria": {
            "nombre": "Cenas",
            "id": "cenas"
        },
        "precio": 18000
        },
        {
        "id": "cena-06",
        "titulo": "espagueti",
        "imagen": "../img/cenas/06.jpg",
        "categoria": {
            "nombre": "Cenas",
            "id": "cenas"
        },
        "precio": 15000
        },
        {
        "id": "cena-07",
        "titulo": "Pad thai",
        "imagen": "../img/cenas/07.jpg",
        "categoria": {
            "nombre": "Cenas",
            "id": "cenas"
        },
        "precio": 17500
        },
        {
        "id": "cena-08",
        "titulo": "Ravioles",
        "imagen": "../img/cenas/08.jpg",
        "categoria": {
            "nombre": "Cenas",
            "id": "cenas"
        },
        "precio": 15300
        }
]

const contenedorProductos = document.querySelector("#contenedor-productos");
const botonesCategorias = document.querySelectorAll(".boton-categoria");
const tituloPrincipal = document.querySelector("#titulo-principal");
let botonesAgregar = document.querySelectorAll(".porducto-agregar");
const numerito = document.querySelector("#numerito")

function cargarProductos(productosElegidos){
    contenedorProductos.innerHTML = "";

    productosElegidos.forEach(producto =>{

        

        const div = document.createElement("div");
        div.classList.add("producto")
        div.innerHTML = `
            <img class="producto-imagen" src="${producto.imagen}" alt="${producto.titulo}">
            <div class="producto-detalles">
                <h3 class="producto-titulo">${producto.titulo}</h3>
                <p class="producto-precio">$${producto.precio}</p>
                <button class="producto-agregar" id="${producto.id}">Agregar</button>
            </div>
        `;

        contenedorProductos.append(div);

    })

    actualizarBotonesAgregar();

}

cargarProductos(productos);

botonesCategorias.forEach(boton => {

    boton.addEventListener("click", (e) =>{
        botonesCategorias.forEach(boton => boton.classList.remove("active"));
        e.currentTarget.classList.add("active");;

        if (e.currentTarget.id != "todos"){
            const productoCatergoria = productos.find(producto => producto.categoria.id ===e.currentTarget.id);
            tituloPrincipal.innerHTML = productoCatergoria.categoria.nombre; 

            const productosBoton = productos.filter(producto => producto.categoria.id === e.currentTarget.id);
            cargarProductos(productosBoton);
        }


        else{
            tituloPrincipal.innerHTML = "Menu Completo";
            cargarProductos(productos);
        }
    })

})

function actualizarBotonesAgregar(){
    botonesAgregar = document.querySelectorAll(".producto-agregar");

    botonesAgregar.forEach(boton => {
        boton.addEventListener("click", agregarAlCarrito);
    });
}



let productosEnCarrito;

let productosEnCarritoLS = localStorage.getItem("productos-en-carrito");

if(productosEnCarritoLS){
    productosEnCarrito = JSON.parse(productosEnCarritoLS);
    actualizarNumerito();
}else{
    productosEnCarrito = [];
}


function agregarAlCarrito(e){
    const idBoton = e.currentTarget.id;
    const productoAgregado = productos.find(producto => producto.id === idBoton);

    if(productosEnCarrito.some(producto => producto.id === idBoton))
        {
            const index = productosEnCarrito.findIndex(producto => producto.id === idBoton);
            productosEnCarrito[index].cantidad++;
        }
    else
        {
            productoAgregado.cantidad = 1;
            productosEnCarrito.push(productoAgregado);
        }

    actualizarNumerito();

    localStorage.setItem("productos-en-carrito", JSON.stringify(productosEnCarrito));
}

function actualizarNumerito(){
    let nuevoNumerito = productosEnCarrito.reduce((acc, producto) => acc + producto.cantidad, 0);
    numerito.innerText = nuevoNumerito;
}
